{% extends "website/base.html" %}
{% block content %}

   {% if user.is_authenticated %}

      <div class="row justify-content-center my-4">
         <div class="col-12">
            <h1 class="mt-3 text-center">Customer records</h1>
         </div>

         <div class="col-3"></div>
         <div class="my-3 col-md-6">
            <form method="get" action="{% url 'website:home' %}">
               <div class="input-group">
                  <input type="text"
                         name="q"
                         class="form-control"
                         placeholder="Search by Name, Surname or Email..."
                         value="{{ request.GET.q }}">
                  <button class="btn btn-primary" type="submit">Search</button>
                  <a href="{% url 'website:home' %}" class="btn btn-secondary">Reset</a>
               </div>
            </form>
         </div>
         <div class="my-3 col-md-3">
            <a href="{% url 'website:add_customer' %}" class="btn btn-success">Add Customer</a>
         </div>
      </div>

      <div class="row justify-content-center">
         <div class="col-11">
            <div class="table-responsive">
               <table class="table table-striped table-hover table-bordered">
                  <thead>
                     <tr>
                        <th scope="col">#id</th>
                        <th scope="col">Created at</th>
                        <th scope="col">Updated at</th>
                        <th scope="col">First name</th>
                        <th scope="col">Last name</th>
                        <th scope="col">Phone</th>
                        <th scope="col">Email</th>
                        <th scope="col">State</th>
                        <th scope="col">City</th>
                     </tr>
                  </thead>
                  <tbody>
                     {% if customers %}
                        {% for customer in customers %}
                           <tr>
                              <th scope="row">
                                 <a href="{% url "website:customer_detail" pk=customer.id %}">{{ customer.id }}</a>
                              </th>
                              <td>{{ customer.created_at|date:"d.m.y H:i" }}</td>
                              <td>{{ customer.updated_at|date:"d.m.y H:i" }}</td>
                              <td>{{ customer.first_name }}</td>
                              <td>{{ customer.last_name }}</td>
                              <td class="text-nowrap">{{ customer.phone }}</td>
                              <td>{{ customer.email }}</td>
                              <td>{{ customer.country }}</td>
                              <td>{{ customer.city }}</td>
                           </tr>
                        {% endfor %}
                     {% endif %}
                  </tbody>
               </table>
            </div>
         </div>
      </div>


   {% else %}

      <div class="row justify-content-center mt-5">
         <div class="col-12 col-md-6 col-lg-4 mb-4">
            <h1>Login</h1>

            <form method="post" action="{% url 'website:home' %}">
               {% csrf_token %}

               <div class="mb-3">
                  <label for="InputUsername" class="form-label">Username</label>
                  <input type="text"
                         class="form-control"
                         id="InputUsername"
                         name="username"
                         required />
               </div>

               <div class="mb-3">
                  <label for="InputPassword" class="form-label">Password</label>
                  <input type="password"
                         class="form-control"
                         id="InputPassword"
                         name="password"
                         required />
               </div>

               <button type="submit" class="btn btn-primary">Submit</button>

            </form>
         </div>
      </div>

   {% endif %}

{% endblock content %}
